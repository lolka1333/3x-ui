# Исправление проблем с генерацией ключей Shadowsocks 2022

## Проблемы, которые были исправлены:

### 1. **Неправильная длина ключа в `randomShadowsocksPassword`**
**Файл:** `/workspace/web/assets/js/util/index.js`
**Проблема:** Метод `randomShadowsocksPassword` не правильно определял длину ключа для различных SS2022 методов.
**Исправление:** Добавлена правильная логика для определения длины ключа:
- `BLAKE3_AES_128_GCM`: 16 байт (128 бит)
- `BLAKE3_AES_256_GCM`: 32 байта (256 бит) 
- `BLAKE3_CHACHA20_POLY1305`: 32 байта (256 бит)

### 2. **Проблема с проверкой метода в конструкторе клиента**
**Файл:** `/workspace/web/assets/js/model/inbound.js`
**Проблема:** В конструкторе `Inbound.ShadowsocksSettings.Shadowsocks` не правильно проверялся параметр `method`.
**Исправление:** Добавлена проверка на пустой `method` перед вызовом `isSS2022()`.

### 3. **Создание клиентов без передачи метода**
**Файл:** `/workspace/web/assets/js/model/inbound.js`
**Проблема:** При создании нового inbound создавался клиент без передачи метода шифрования.
**Исправление:** Исправлен конструктор `ShadowsocksSettings` для передачи метода при создании клиента.

### 4. **Отсутствие метода при создании нового клиента в интерфейсе**
**Файл:** `/workspace/web/html/modals/inbound_modal.html`
**Проблема:** В функции `SSMethodChange()` создавался новый клиент без передачи метода.
**Исправление:** Добавлена передача метода при создании нового клиента и генерация пароля для существующих SS2022 клиентов.

## Что исправлено:

1. **Автоматическая генерация ключей SS2022** - теперь ключи для inbound и клиентов генерируются автоматически с правильной длиной
2. **Правильная передача метода** - метод шифрования теперь корректно передается от inbound к клиентам
3. **Обновление паролей при изменении метода** - когда пользователь меняет метод SS2022, автоматически генерируются новые пароли для клиентов
4. **Устранение ошибок SS22** - исправлены причины постоянной перезагрузки сервера из-за неправильных ключей

## Результат:

После этих исправлений:
- ✅ Ключи для SS2022 inbound генерируются автоматически
- ✅ Ключи для SS2022 клиентов генерируются автоматически
- ✅ Устранены ошибки SS22 и перезагрузки сервера
- ✅ Правильная длина ключей для всех SS2022 методов
- ✅ Корректное наследование метода от inbound к клиентам

Теперь генерация ключей Shadowsocks 2022 работает правильно как для inbound, так и для всех клиентов.